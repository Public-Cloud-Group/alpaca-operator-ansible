- name: Configure ALPACA Operator command for MHP
  hosts: local
  gather_facts: false

  tasks:
    - name: "Ensure command BKP: System health check MHP is configured"
      pcg.alpaca_operator.alpaca_command:
        system:
          systemName: "MHP"
          
        command:
          state: present
          name: "BKP: System health check MHP"
          agentName: "hdbmhpa"
          
          parameters: "-p health -s <HEALTH_CHECK_SRC> -l 2 -d <HEALTH_CHECK_DEST> -h DB_HOST"

          schedule:
            period: "every_hour"
            time: "12:00:00"
            cronExpression: ""
            daysOfWeek:
              - monday
              - tuesday
              - wednesday
              - thursday
              - friday
              - saturday
              - sunday
              
          parametersNeeded: False
          disabled: False
          critical: True
          autoDeploy: False
          history:
            documentAllRuns: True
            retention: 100
          timeout:
            type: default
            value: 14
          escalation:
            mailEnabled: True
            smsEnabled: False
            mailAddress: "monitoring@pcg.io"
            smsAddress: ""
            minFailureCount: 1
            triggers:
              everyChange: True
              toRed: True
              toYellow: False
              toGreen: False
        apiConnection:
          host: "nightly03.lnwsoft.corp"
          protocol: "https"
          port: "8443"
          username: "pms*"
          password: "pms"
          tls_verify: "False"